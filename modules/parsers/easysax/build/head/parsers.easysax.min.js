"object"===typeof exports&&this==exports&&(module.exports=EasySAXParser);
function EasySAXParser(){function u(){}function R(b,e,h,p){return p?S[p]||"":e?String.fromCharCode(e):String.fromCharCode(parseInt(h,16))}function w(b,e){b=String(b);3<b.length&&-1!==b.indexOf("&")&&(-1!==b.indexOf("&gt;")&&(b=b.replace(/&gt;/g,">")),-1!==b.indexOf("&lt;")&&(b=b.replace(/&lt;/g,"<")),-1!==b.indexOf("&quot;")&&(b=b.replace(/&quot;/g,'"')),-1!==b.indexOf("&")&&(b=b.replace(/&#(\d+);|&#x([0123456789abcdef]+);|&(\w+);/ig,R)));return b}function D(){if(null!==q)return q;var b={},e=A,h=
B,p=e.length,k=x?[]:!1,r=!1,f,c,g;a:for(;h<p;h++){var a=e.charCodeAt(h);if(!(32===a||14>a&&8<a)){if(65>a||122<a||90<a&&97>a)return q=!1;for(f=h+1;f<p;f++)if(a=e.charCodeAt(f),!(96<a&&123>a||64<a&&91>a||47<a&&59>a||45===a||95===a)){if(61!==a)return q=!1;break}var l=e.substring(h,f);r=!0;if("xmlns:xmlns"===l)return q=!1;a=e.charCodeAt(f+1);if(34===a)f=e.indexOf('"',h=f+2);else if(39===a)f=e.indexOf("'",h=f+2);else return q=!1;if(-1===f||f+1<p&&(a=e.charCodeAt(f+1),32<a||9>a||32>a&&13<a))return q=!1;
var n=e.substring(h,f);h=f+1;if(y){if(x){if(g="xmlns"===l?"xmlns":120===l.charCodeAt(0)&&"xmlns:"===l.substr(0,6)&&l.substr(6)){if(a=E[w(n)]){if(m[g]!==a){if(!d){var d=!0;f={};for(c in m)f[c]=m[c];m=f}m[g]=a}}else if(m[g]){if(!d){d=!0;f={};for(c in m)f[c]=m[c];m=f}m[g]=!1}b[l]=n;continue}k.push(l,n);continue}for(a=l.length;--a;)if(58===l.charCodeAt(a)){if(a=m[l.substring(0,a)])b[a+l.substr(a)]=n;continue a}}b[l]=n}}if(!r)return q=!0;if(x)a:for(h=0,p=k.length;h<p;h++){l=k[h++];for(a=l.length;--a;)if(58===
l.charCodeAt(a)){if(a=m[l.substring(0,a)])b[a+l.substr(a)]=k[h];continue a}b[l]=k[h]}return q=b}function F(b){function e(){return b.substring(g,c+1)}b=String(b);for(var h=[],p=[],k,r=!1,f=!1,c=0,g=0,a,l,n,d,v,z=0,C;-1!==c;){v=0<z;g=60===b.charCodeAt(c)?c:b.indexOf("<",c);if(-1===g){h.length&&t("end file");break}if(c!==g&&!v&&(a=G(b.substring(c,g),w),!1===a))break;d=b.charCodeAt(g+1);if(33===d)if(d=b.charCodeAt(g+2),91===d&&"CDATA["===b.substr(g+3,6)){c=b.indexOf("]]\x3e",g);if(-1===c){t("cdata");
break}if(!v&&(a=H(b.substring(g+9,c),!1),!1===a))break;c+=3}else if(45===d&&45===b.charCodeAt(g+3)){c=b.indexOf("--\x3e",g);if(-1===c){t("expected --\x3e");break}if(I&&!v&&(a=J(b.substring(g+4,c),w),!1===a))break;c+=3}else{c=b.indexOf(">",g+1);if(-1===c){t('expected ">"');break}if(K&&!v&&(a=L(b.substring(g,c+1),w),!1===a))break;c+=1}else if(63===d){c=b.indexOf("?>",g);if(-1===c){t("...?>");break}if(M&&(a=N(b.substring(g,c+2)),!1===a))break;c+=2}else{c=b.indexOf(">",g+1);if(-1==c){t("...>");break}q=
!0;if(47===d){f=!1;r=!0;a=k=h.pop();n=g+2+a.length;if(b.substring(g+2,n)!==a){t("close tagname");break}for(;n<c;n++)if(d=b.charCodeAt(n),!(32===d||8<d&&14>d)){t("close tag");return}}else{47===b.charCodeAt(c-1)?(a=k=b.substring(g+1,c-1),r=f=!0):(a=k=b.substring(g+1,c),f=!0,r=!1);if(!(96<d&&123>d||64<d&&91>d)){t("first char nodeName");break}n=1;for(l=a.length;n<l;n++)if(d=a.charCodeAt(n),!(96<d&&123>d||64<d&&91>d||47<d&&59>d||45===d||95===d)){if(32===d||14>d&&8<d){k=a.substring(0,n);q=null;break}t("invalid nodeName");
return}r||h.push(k)}if(y){if(v){r?f||0===--z&&(m=p.pop()):z+=1;c+=1;continue}C=m;r||(p.push(m),!0!==q&&(x=-1!==a.indexOf("xmlns",n))&&(A=a,B=n,D(),x=!1));d=k.indexOf(":");-1!==d?(v=m[k.substring(0,d)],k=k.substr(d+1)):v=m.xmlns;if(!v){r?m=f?C:p.pop():(z=1,q=!0);c+=1;continue}k=v+":"+k}if(f){A=a;B=n;a=O(k,D,w,r,e);if(!1===a)break;q=!0}if(r){a=P(k,w,f,e);if(!1===a)break;y&&(m=f?C:p.pop())}c+=1}}}if(!this)return null;var G=u,O=u,P=u,H=u,t=u,J,N,L,I,M,K,y=!1,E,Q,m={xmlns:void 0},x=!1;this.on=function(b,
e){if("function"===typeof e||null===e)switch(b){case "error":t=e||u;break;case "startNode":O=e||u;break;case "endNode":P=e||u;break;case "textNode":G=e||u;break;case "cdata":H=e||u;break;case "comment":J=e;I=!!e;break;case "question":N=e;M=!!e;break;case "attention":L=e,K=!!e}};this.ns=function(b,e){if(b&&"string"===typeof b&&e){var h={},p,k;for(k in e){var r=e[k];"string"===typeof r&&(b===r&&(p=!0),h[k]=r)}p&&(y=!0,Q=b,E=h)}};this.parse=function(b){"string"===typeof b&&(y?(m={xmlns:Q},F(b),m=!1):
F(b),q=!0)};var S={constructor:!1,hasOwnProperty:!1,isPrototypeOf:!1,propertyIsEnumerable:!1,toLocaleString:!1,toString:!1,valueOf:!1,quot:'"',QUOT:'"',amp:"&",AMP:"&",nbsp:" ",apos:"'",lt:"<",LT:"<",gt:">",GT:">",copy:"©",laquo:"«",raquo:"»",reg:"®",deg:"°",plusmn:"±",sup2:"²",sup3:"³",micro:"µ",para:"¶"},A="",B=0,q};
